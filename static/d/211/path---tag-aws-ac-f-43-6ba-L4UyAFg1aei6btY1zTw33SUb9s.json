{"data":{"site":{"siteMetadata":{"title":"RayLog"}}},"pageContext":{"posts":[{"html":"<h1>AWS - Architecture study: WEB APPLICATION HOSTING</h1>\n<p>일단 이 글을 읽는 이들은 다음과 같은 조건을 충족했다고 가정한다.</p>\n<ul>\n<li><a href=\"https://rayleighko.github.io/blog/2019-02-12-aws_ac_web_2\">이전 글(이론)</a>을 읽었다.</li>\n<li>AWS 계정이 있다(Free tier가 아니여도 무관하다).</li>\n<li>루트 계정이 아닌 유저 계정으로 콘솔에 접속했다(루트 계정은 이메일로 되어있는 계정을 말하고 유저 계정은 관리자가 정한 계정을 말하는데, 루트 계정으로 작업을 하게 되면 보안에 취약할 수 있으니 반드시 유저 계정을 따로 생성하길 바란다).</li>\n<li>과금이 발생할 수 있음을 인지하고 있다.</li>\n</ul>\n<p>여기서 우리는 다음의 5가지(크게 7가지) 서비스를 사용해볼 것이다.</p>\n<ul>\n<li>EC2(ELB, Auto-Scaling)</li>\n<li>RDS</li>\n<li>S3</li>\n<li>CloudFront</li>\n<li>Route 53</li>\n</ul>\n<p>이제 어떻게 구현하면 좋을지 생각해보자. 먼저 EC2를 만들고, html로 랜딩 페이지를 띄우고, 이를 ELB로 로드밸런싱할 것이다. 더불어 S3에는 이미지를 저장하고, 이를 CloudFront로 정적 이미지를 제공해줄 것이다. 이때 데이터베이스는 RDS에서 MySQL로 제공할 것이고, 결과적으로 오토 스케일링이 가능라도록 구현하고자 한다. 나는 이를 가장 쉽게 설명하고 있는 <a href=\"https://aws.amazon.com/web-applications/gsg-webapps-linux/\">Getting Started with Linux Web Applications in the AWS Cloud</a>을 따라 만들어 볼 것이다!</p>\n<p>만약 필자와 같은 선택을 할 것이라면 본격적으로 실습을 진행해보자. 내가 이 글을 쓰는 지금(2019. 02. 26)의 AWS 콘솔의 첫 페이지는 다음과 같다.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9608e87e453c04fc6a5d7f2da593ecca/3a344/aws-main.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 650px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 55.347222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABsklEQVQoz31S7W7UMBC8RweE1PaActeCeuIPT4ZUlct3nNhJnDh2kmF3j6ZqQI00yq7tHe/Mend9+w2fjw+4OTzg6vY77k4/saf4w80R766+4v31QeIt+OyX+x/4dDxJvD+c8HF/hx3oC1NAmqYoVYkojiVWlZI8z3PZf/tb/gLY1VqjqmskRJLlBZqmvaC9/I1p0LYd2u4FpaoQJ4nU5FTD+xcejZ1pGinOqBNVVXDjiNF7zPMsWJZljZ9RUwMxKfkdxaQogXOjXMRcK2FnrSzy3zmHkYjDNGEigi20NtRdhlRpaFLRD4NwrIRM1PeDSBwG93+HlpeYbYiiCJbqQgjSwCtCTmrSzz6w5IFuFNBBhtuAPf/1+IRznKIim1jNKvmZOU4yPD6didSIyU3Xi5fej3SJR08+9dQ9rxljEGeFyJ3oBbCv/3SoDE3Kegx+pq48okKjtYPILDQNre5gx0mGxJJjGkZRlChpbxjD66HwIJIkJR+tEFjKz+dofVspDUCV6uIhE1INn287K0q83xByonQDS53NxOHDBN32cGGW3LSWcrsh5HeYI8pK8tCvhH8AcBk4zjJ6gG8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"aws-main\"\n        title=\"\"\n        src=\"/static/9608e87e453c04fc6a5d7f2da593ecca/6b671/aws-main.png\"\n        srcset=\"/static/9608e87e453c04fc6a5d7f2da593ecca/f7a0c/aws-main.png 163w,\n/static/9608e87e453c04fc6a5d7f2da593ecca/608ba/aws-main.png 325w,\n/static/9608e87e453c04fc6a5d7f2da593ecca/6b671/aws-main.png 650w,\n/static/9608e87e453c04fc6a5d7f2da593ecca/1ee70/aws-main.png 975w,\n/static/9608e87e453c04fc6a5d7f2da593ecca/f242c/aws-main.png 1300w,\n/static/9608e87e453c04fc6a5d7f2da593ecca/3a344/aws-main.png 1440w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span>\n  </a></p>\n<p>여기서 예제의 처음에 등장하는 S3 버킷을 생성해보자. 예제의 영상은 오래 되었지만, 그 동작은 변함이 없다. 검색란에서 S3를 검색해 'aws-webapp'이라는 bucket을 서울 리전에 만들어보자(S3는 생성 시 리전을 고를 수 있다).</p>\n<p><img src=\"./assets/aws-s3.png\" alt=\"aws-s3\"></p>\n<p>Create bucket을 눌러 아래와 같이 'aws-webapp'이라는 버킷을 만들자(버킷은 이름의 중복을 피해야 한다. 가령 다른 사람이 aws-webapp을 사용하고 있다면 그 이름을 사용할 수 없다. 그래서 나는 aws-webapp-mj라는 버킷을 만들었다).</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/55a3692a6246c0c11e677f616a78d37d/3a344/aws-s3-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 650px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 55.486111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACH0lEQVQoz32R+U4aURTGebA2TaFCm6al1ZBitRorUDvDYpCGZQSVTQcG44zKUPZNLWAjmyglvkBfoC+goU36Dl/vHcR00f7xy3fPnHu/fOeMivWF4eDCMHIiJnwynnIp6Nz70KyIeOjcIYjQfZAU1M7RNzXp0b7GJUHrkaFlQ9DOLEH9ygzVQbuPWqsHX/8bXl/8hLF9Cf3JJV42rzDdHWK2N8T82XfMEYyknjkdKr0XBGPnCvr2D5gPvyKWLiORP4IqW2ui1GjDuZ2DYVWEgSa1RxQeO6IKGltEQXddj/tPlqNQW8OwxTKonw5Q6w6gytebKBx3wPh5uEICgmIaPl4CF5MUHZ//qYn6hT1Y/VGw/i1UmueoNs/IyK1zHHW+wLaRACfI2JSL4D+WCRUyBqV6rePzqOYJidwhvPEkmHUB+ZM+qJdiWCNxHcEE7BsCuPg+1nbSCqsJ+U44Ar1D3zBrccWwemNIZreThDRdvt5CstJAjqhUqkEq3o5Y/IRk9RjrZEXM2t8Ju6OEXpJOyFSxlSohTkfKHtwJvUdN/dspvP/dkC6SGrIBHvcMJkzMWfHoDQvN7P+hdx5ML+G+YRFmbwSZz73RT6n3LtAgBMQsLAEBk4wbU4yH6G24b/rPLS6wZE2mcArm4C7KnQGol4pPFhCTC3BvSjC5w3i2YId+cflP3o500rKiMPXOpdQWTwjz3hgWvDwie3lEdrP4BXgVOQ1p1OK3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"aws-s3\"\n        title=\"\"\n        src=\"/static/55a3692a6246c0c11e677f616a78d37d/6b671/aws-s3-2.png\"\n        srcset=\"/static/55a3692a6246c0c11e677f616a78d37d/f7a0c/aws-s3-2.png 163w,\n/static/55a3692a6246c0c11e677f616a78d37d/608ba/aws-s3-2.png 325w,\n/static/55a3692a6246c0c11e677f616a78d37d/6b671/aws-s3-2.png 650w,\n/static/55a3692a6246c0c11e677f616a78d37d/1ee70/aws-s3-2.png 975w,\n/static/55a3692a6246c0c11e677f616a78d37d/f242c/aws-s3-2.png 1300w,\n/static/55a3692a6246c0c11e677f616a78d37d/3a344/aws-s3-2.png 1440w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span>\n  </a></p>\n<p>Copy할 버킷이 없으므로 다음으로 넘어가자. 다음으로 넘어가게 되면 다양한 속성들을 설정할 수 있는데, 만약 사용할 기능이 있다면 체크해도 좋지만 나는 여기서 따로 사용할 기능이 없기 때문에 Tags에 Name이라는 key를 webapp으로 만들어주고 다음으로 넘어갈 것이다.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c2f24c16a02dbe2053ee7193fe516139/3a344/aws-s3-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 650px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 55.41666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACZ0lEQVQoz3WS61JSURiGubLKKdJJ2BxK85BycLNRwA2CbN2bRBFCDuIopWQcdEINyDEYCDVzxgvoBrqAzKY/3cHbtxb2y+nHM2t9a6/9zLu+tXReNQF/JIGhyCYeqgUMaAXolW30Bbdwb24T9wn9fJ7zgNZYzUZGXyiPR4u03xuHfmwafcMidEftL6i3uli5/A7b1R+Mdq5hbv7AcPsnJk9/cWxnPUY/3+BF9wbW1jUsBNtr6fyGu/YN2WIVG3s16Er1JvYaLcTe1SDnD+DOVOBIFiGmSpDSZbgJ51oZDkJKV/h3MVXmsLk9WUJk5wj1DgXrXEBXaZDwYxueaAYuJQaRGJc1QsXzWRWmmQUIYgDClB9GZw827xHAwKQXvmgK1eYZDpqn0B22zvCBjj27msNYYAkOJY5R/xKsXhWPJQV6RwAGMQSD6y5GaR79dj9mltdRaZ7jgFxcyKIGSJjeraJMaXOlQ8R39pHdqyOWL8LsDmNwag5GMUjyIB+NJBRIOGCXSZi9K5RjOWy8P8Hu8SmcC3HYwzG4tSSfW2cU/rNBClOqME/WE4b+L/RTQokEvuUMhmc1zpBPxTNihFpg8WoweFQIhGF6gSflCR105CgJP90KWSNr1EM5to6J0Aq/HBulY8IROQKrT+MCwUUCluofJBt0BtA/4YFLfYXicbd3KY3uV5ycX0GmhE+mgpRKg4Vu1kR9M00rMBMWBq2Zb2sGE/oS27CtvoUUf41q+wKN7iV0a28qyBT24X2ZhFmcg0BHEOhpmOhJmJw9eE1YKaWV+vaUYHslNYVxJQ3H4hri+TISW0X8BXvWH610XH6FAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"aws-s3\"\n        title=\"\"\n        src=\"/static/c2f24c16a02dbe2053ee7193fe516139/6b671/aws-s3-3.png\"\n        srcset=\"/static/c2f24c16a02dbe2053ee7193fe516139/f7a0c/aws-s3-3.png 163w,\n/static/c2f24c16a02dbe2053ee7193fe516139/608ba/aws-s3-3.png 325w,\n/static/c2f24c16a02dbe2053ee7193fe516139/6b671/aws-s3-3.png 650w,\n/static/c2f24c16a02dbe2053ee7193fe516139/1ee70/aws-s3-3.png 975w,\n/static/c2f24c16a02dbe2053ee7193fe516139/f242c/aws-s3-3.png 1300w,\n/static/c2f24c16a02dbe2053ee7193fe516139/3a344/aws-s3-3.png 1440w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span>\n  </a></p>\n<p>다음으로 넘어가게 되면 다시 한 번 체크 박스가 나온다. 여기서도 사용자의 필요에 따라 체크를 하지 않을 수 있지만, 권장 사항이기 때문에 체크하고 넘어가는 것이 바람직할 것 같다. 더불어 Manage system permissions는 S3 로그 전달 그룹(Delivery group)에 이 버킷의 로그가 쓰여지는 것을 허용할 것이냐는 말인데, 지금 당장 로그 정보가 필요없으니 허용하지 않고 넘어갈 것이다.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/52e6474dec63308124774db90162e8bf/5638c/aws-s3-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 650px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 55.82865168539326%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACc0lEQVQoz22S2VIaQRSG582SWMHEJSKYGFkVFQVUlhkGRkAWkV0FxGUiJZZRXNAqBAUTTVJ5iuQ+idGbPMOf02NSpVVefH1O93R/fU7XcFOzC3AF43gbLOB5QEZ3UMYLaR0dwgqeeIp4yheh8q6gU1xRcrb2jL+D7VH516Fy56AyOtAxaAVXPbtErdFC7Oo79F/+4E3jJ3pOfkBT/wVT6wZDZ79hoDh8cQtj+0ZB27hGX/0ag81raJq3MNS+IVWuYqlyAK58eIqd4ybEQgWD4RLMcRn62AaM8zJMsTXoIqtQS3l08Vn0iTmoxUX0eHPoFnI0X1TWTdFVVBsfcHR+BW6bZLv1NqYj9MEVgDOcxlQooTAsRKCbkWB0StBP+6GnfGjKDx3LCYNzFhqrB0ZXEJWTc+yeXoDbo2G/+RHOeB4jvjgckRxscxnYwlmMhjIwinFoHXTQ7lfo/xcZWoeEXqsAAx/Fu+MWdqlKjpV63P4EPlFQhLa5NCaDKdgpWgNJjEkL0NGB7jEPesf5B7wiWdeom4SRh8Ja654wlMZEgAkzGPEnoLZRNTYf1JM+OuzBS4sLXRY34VJkneaZR4RUoWchT6IkBBKz3E7iUd+8UuE4YzYBszcGE72rSYgqcZjmevccTBTl2vmdkL3hUesK7vgyfKkiFjffI72xjdR6Bcm1LYWsvINCZR/F7YN7HCK/VUWiVIZFjKJUPb0THlG79cuvSsusBY2dtSdSqyL6qdX/KGv3YO834k/DEqFfS8pi86SFw/ZncMvlPZToxplwBv1WHgOTXmgnhEcZsHnxmi5iaGivPZTFdFKGQcohtbGDJXL9BdYdJQBg6TCVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"aws-s3\"\n        title=\"\"\n        src=\"/static/52e6474dec63308124774db90162e8bf/6b671/aws-s3-4.png\"\n        srcset=\"/static/52e6474dec63308124774db90162e8bf/f7a0c/aws-s3-4.png 163w,\n/static/52e6474dec63308124774db90162e8bf/608ba/aws-s3-4.png 325w,\n/static/52e6474dec63308124774db90162e8bf/6b671/aws-s3-4.png 650w,\n/static/52e6474dec63308124774db90162e8bf/1ee70/aws-s3-4.png 975w,\n/static/52e6474dec63308124774db90162e8bf/f242c/aws-s3-4.png 1300w,\n/static/52e6474dec63308124774db90162e8bf/5638c/aws-s3-4.png 1424w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span>\n  </a></p>\n<p>마지막으로 지금까지의 설정을 확인하고 되묻는데, 여기서 제대로 설정했는지를 확인하고 생성을 마치도록 하자.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bfd7adee2c7548bb808b1704a41bb866/3a344/aws-s3-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 650px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 55.27777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABkklEQVQoz62Qy0sCURTG568qInpQLoIkogcRQhgUtK516xatWkQEQX9DQi/LTDMsIiHKsvDZKs2hcWac0Xl9nXvVUqMI6sBvznfO/c6ZmSusrm1gfXMbS8sr6BudwdT8ItyeBbgmZjE47sXAmJdyTbvquZt8HW4Puoan0TPiQS/V/ZNz6ByagoB6lCtVxOIJ3NzF8ZjOIpF5xiORSD9zzUnnOPepHG6TGdw+pRB7SCIaT+LyIUV1GkJRFCESLHTTRraoQNYq+E1UKzocx27pCZL0hnxRhGHZyIgatqI5XGdfYZBZVlWUNQ0qoelUKypUvQLDNEkrHKlUwks+D4W8Fu2gX3a4YAsBG5auQJUlVA0Dtk21ZX3AFrxJJag0XJJlnhXq5QsFqOUyfa3zeYdUwSZMWmyaFj9sD9ZjL2E0dLOPL2QP1qtl58uCZn6KhkdoGNuH2/vfedrPhdr9tN7VXxDwzyEEw1GEIheIRK9wFDzDzq4fvv1j+PaO6tQ19Q4CIRyehOEnDkn7yc8ymwucnnP9Dt5XJ4/nx/LXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"aws-s3\"\n        title=\"\"\n        src=\"/static/bfd7adee2c7548bb808b1704a41bb866/6b671/aws-s3-5.png\"\n        srcset=\"/static/bfd7adee2c7548bb808b1704a41bb866/f7a0c/aws-s3-5.png 163w,\n/static/bfd7adee2c7548bb808b1704a41bb866/608ba/aws-s3-5.png 325w,\n/static/bfd7adee2c7548bb808b1704a41bb866/6b671/aws-s3-5.png 650w,\n/static/bfd7adee2c7548bb808b1704a41bb866/1ee70/aws-s3-5.png 975w,\n/static/bfd7adee2c7548bb808b1704a41bb866/f242c/aws-s3-5.png 1300w,\n/static/bfd7adee2c7548bb808b1704a41bb866/3a344/aws-s3-5.png 1440w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span>\n  </a></p>\n<p>다음으로 예제가 설명하고 있는 것은 CloudFront인데, 이 동영상의 링크가 잘못된 것인지 EC2를 생성하는 예제를 설명한다. 따라서 나는 <a href=\"https://docs.aws.amazon.com/ko_kr/AmazonCloudFront/latest/DeveloperGuide/GettingStarted.html\">CloudFront 시작하기</a>라는 AWS CloudFront 튜토리얼을 읽어야만 했다.</p>\n<p>우선은 CloudFront를 사용하기 위해선 앞선 설명처럼 S3의 버킷이 생성되어 있어야 하고, 컨텐츠가 업로드되어 있으며 객체 권한이 부여되어 있어야 한다.</p>\n<p>이를 위해 해당 문서의 <strong>Amazon S3에 콘텐츠를 업로드하고 모두에게 읽기 권한을 부여하는 방법</strong>을 따라 S3의 설정을 진행하도록 하자. 우리는 \"6. <strong>버킷</strong> 창에서 버킷을 선택하고 <strong>업로드</strong>를 선택합니다.\"부터 진행하면 될 것이다.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8815065789df870264505531a319bd98/3a344/aws-s3-6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 650px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 55.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACXklEQVQoz2WS61MSYRTG+cOraaYmtQkzSzNrmuky0wdNLS3RLiMoBZIMiiKKyk1gAYGFBXZhF36dfcM+1M48ey7veZ9zznuOZ3xyhrGHs0xMz3PXO8Pcy7fMPn+F9/E8D6ZdPBtB9EdzeEXe8z7h9viUyBkmpp4yNjmr5J3703gYfY7dk1+f4F6MtWCEzR8RfIGf+EJRfGKvi74RjrEaCJMtaurOkP8/j2n1+JVvEcrq7GSaBA5S7MWP2dlPEj1MEjtOEUucEjs6YT95RvQoiVap4jgOpmXRaOiCBp1uF6vXwzMYDtnXOuwVO/zMG5Q6A2zJ1HZAalZ6fySv0ZWzpuUoXBmmgm72VcWK0Og51E0bXQIqnT4lo89lo0O6opOuNslctQTGH1uQq7cpt20qwly1hpQ77j0bl0sR1ro2mpBoRk8C++rQlVrLoiy+kshSw1D6tc+NKUjSrFYV26L6L2FFssQzJWIXBbQRqZtAl/YWlj/yej2AZkFFzqrdAZdS5Y2bt5h8s0TBsLn6SzgYSrtSujkgVaqxFU2QlRarbjsCTbK/W1xiMRgnb4hPnsSNLehdFj6ssRJJid9WRSlCxxmgNbscpQscnGU4PM+RLjfkXWzydYP4eZ7jbJGTdJ5E+lI9Ra7WInaaIZEpkLzIET/LSoIOLpfaQ2OAqqYsmcvmkJa02RZ/U6QuI3YnX+wOaYjeklHWZBBFIcjrJpr4672hilV7GIpE2ZLlDUQOZJF3ee/zs7IZYHnDLwiw+nWbFyvfmVv6hs8f4vNWSOLCbGzvqvhPYrv6l50I/mCY30sFGVrRy2xPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"aws-s3\"\n        title=\"\"\n        src=\"/static/8815065789df870264505531a319bd98/6b671/aws-s3-6.png\"\n        srcset=\"/static/8815065789df870264505531a319bd98/f7a0c/aws-s3-6.png 163w,\n/static/8815065789df870264505531a319bd98/608ba/aws-s3-6.png 325w,\n/static/8815065789df870264505531a319bd98/6b671/aws-s3-6.png 650w,\n/static/8815065789df870264505531a319bd98/1ee70/aws-s3-6.png 975w,\n/static/8815065789df870264505531a319bd98/f242c/aws-s3-6.png 1300w,\n/static/8815065789df870264505531a319bd98/3a344/aws-s3-6.png 1440w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span>\n  </a></p>\n<p>업로드 시 유의해야 할 사항은 읽기와 쓰기 권한의 설정이다. 필자의 이미지는 S3를 필자의 AWS계정에서만 사용 가능하도록 설정할 것이다. 더불어 여기서는 암호화 또는 태깅과 같이 객체에 원하는 속성을 설정할 수 있는데, 이는 사용자가 알맞게 사용하면 된다.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/afe834832c776264de2bd9968c862d69/3a344/aws-s3-7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 650px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 55.486111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACcUlEQVQoz22SW08aURSF+WV9qK2VaoNotGm1iRpBURQBYYa7OiPKdUSu4giViyilIl4ASZs2aZs+WPVZrW/9H6t7Bppo0oeVtXdmznf25ShmbTz0Ng7DzgiUrjRUnm0obUk8t8TQtRglj0LJxNBD6rK0825r218wcfTYUxhmw5iz85hmOChKZ59QPmnCcnwN9ekf9Fbu8axwC1X5HuoPUnyDvv07yn/Lrizd4Wn+Bt3FW/SVbvEkf4eZgwuZsXfSgiJXrWM9d4TQ4RdEzn4iVPuBQPUbhNp3xBoXiJ9fIdL4hWjzEsnWFeWXchwjT0hx6xqJ2lfsVo4hsRTFWhPh0inc8V14k7vwRESwgQRswSTs4TQcQhouYQtOckd4S5az49I3WzAln8tWGyjWztvAXK2F2aUgxphVEo83C268M7mhYVYwYnRhxhOA1unDW6MHI6aOKB41L2FIb8e024+d6jkKxJKBGUrmVgRMsDwm7WsEc2GYCWA0XMGgeQ0jC04ZptYxGJiRxGKA4kHyVxqzXEzm6BGwCdPaJphOq6w/Dj0XwVxAhG5ZgJEXYOA3oPME5Wr/SU8gDRUwzwlUYRPFh0CLLw5vfAfBdA7+FM0zJoKPpOBLZhHe2ZMlZB5r8/0+fFs5OhuDeNgBFo4aED/WobV70TthgHraiv4pi+xqXVtSe/+TSruIl+MGaB1ebFfqkFiKA3qH+WNail+Eit2guXRm9EDS7PofwugfFV0qbXkqUIBmdRt5eoPl+mco1hNZajUrt6xx+DFm9mB8cakt2uIE+WuDG0Pz0ta5tlgOk9YVLCyHaJYhGLgNcNEMVqMi/gJN3juep+pe0gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"aws-s3\"\n        title=\"\"\n        src=\"/static/afe834832c776264de2bd9968c862d69/6b671/aws-s3-7.png\"\n        srcset=\"/static/afe834832c776264de2bd9968c862d69/f7a0c/aws-s3-7.png 163w,\n/static/afe834832c776264de2bd9968c862d69/608ba/aws-s3-7.png 325w,\n/static/afe834832c776264de2bd9968c862d69/6b671/aws-s3-7.png 650w,\n/static/afe834832c776264de2bd9968c862d69/1ee70/aws-s3-7.png 975w,\n/static/afe834832c776264de2bd9968c862d69/f242c/aws-s3-7.png 1300w,\n/static/afe834832c776264de2bd9968c862d69/3a344/aws-s3-7.png 1440w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span>\n  </a></p>\n<p>다음으로 넘어가면 다시 여러 속성을 만날 수 있는데, 나는 기본 세팅 그대로 설정해주고 넘어가도록 할 것이다(지금 당장 필요가 없는 설정이기도 하고 귀찮기 때문).</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3ec0d347303704bf9a94f2ed8e825901/3a344/aws-s3-8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 650px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 55.347222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABuklEQVQoz61RTUscQRCd3xovboK7RvxOgrjGGNcRPyIk8Rd4UW+CMUGTQPCSmwdRQRFk2XV3pudrZ6ane16qeseRCAs5pOB1ve4u3quutuyNT3i3zviM+vImltY+om5vYXbBxvR8AzOc6yt/8bmlNbylmvdUa3/YRoM07M1tLK5uwUIZuVlPTn9j58sP7H/9id3DY+wd/8Lutz7f/36KncMTXN81MSisNJW4vfdw0xa4ajpodly4joOOIxD1YvR6vT7iRx4nCZIkJSSIouKM7mWWwVI6x9Glg4PzLvbOOrhoB5AyRTdKkWYKSmsopZCpPte5NpzBAl0yb7VaxjDPc3oyLTolh9ADtITKJOKUxEiUO2EeUXGr3YbreQijCK4Q5s7zfSPIYgnVGUFeYmrfER4CKjbu5Cwz9diJlAjCsERET+RzFmIDBndbCjIevkUX+6d4Gua8yNyALvaWprnkA0T+FaWBmeF/DisMAwgasuN04fs09CBAEPgGPn2C54kSQriD4fazNb/YwOSrOYxPv8HY1GsMV8fxvDaBCuWhSg3PhqsYYlSqqNTobnTCgPmLl0UencTI2JThfwDGVxs9oLuAmAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"aws-s3\"\n        title=\"\"\n        src=\"/static/3ec0d347303704bf9a94f2ed8e825901/6b671/aws-s3-8.png\"\n        srcset=\"/static/3ec0d347303704bf9a94f2ed8e825901/f7a0c/aws-s3-8.png 163w,\n/static/3ec0d347303704bf9a94f2ed8e825901/608ba/aws-s3-8.png 325w,\n/static/3ec0d347303704bf9a94f2ed8e825901/6b671/aws-s3-8.png 650w,\n/static/3ec0d347303704bf9a94f2ed8e825901/1ee70/aws-s3-8.png 975w,\n/static/3ec0d347303704bf9a94f2ed8e825901/f242c/aws-s3-8.png 1300w,\n/static/3ec0d347303704bf9a94f2ed8e825901/3a344/aws-s3-8.png 1440w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span>\n  </a></p>\n<p>이로써 필자는 S3에 파일을 업로드할 수 있었다. 이처럼 업로드가 완료된 파일은 URL을 통해 접근할 수 있는데 필자의 경우 다음과 같은 URL로 파일에 접근할 수 있을 것이다.</p>\n<blockquote>\n<p>s3://aws-webapp-mj/40321838.png</p>\n<p>혹은</p>\n<p><a href=\"https://s3.ap-northeast-2.amazonaws.com/aws-webapp-mj/40321838.png\">https://s3.ap-northeast-2.amazonaws.com/aws-webapp-mj/40321838.png</a></p>\n</blockquote>\n<p>다음으로는 CloudFront 배포를 만들 것이다. CloudFront 배포를 만들려면 문서의 과정을 거쳐야 하는데, 그 중 가장 먼저 할 것은 CloudFront의 콘솔을 열어 <strong>[Create Distribution]</strong>을 선택한 후, [<strong>Select a delivery method for your content</strong>]의 [<strong>Web</strong>] 섹션에서 [<strong>Get Started</strong>]를 선택하는 것이다. 이 과정은 내가 따로 적을 필요없이 <a href=\"https://docs.aws.amazon.com/ko_kr/AmazonCloudFront/latest/DeveloperGuide/GettingStarted.html\">문서</a>에 매우 잘 나와있기 때문에 문서를 참고하도록 하자.</p>\n<p>나는 S3를 설정한 것 외에는 전부 기본값을 사용해서 다음과 같은 CloudeFront Distributions(배포판)을 만들었다.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e3170a7ac6872a024aec5b7487eceffb/3a344/aws-cloudfront.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 650px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 55.486111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABYklEQVQoz62Q60sCURDF7//dhyg0RC0tzSLo38goUCsfSWIQJIbu0i5sWj5287Xr89e9ViB+SujAMIeZueeeGbHtC+IPRogmzgkdHBGLn7IXOmRrN8hOIIo/HMcXiuH/CcV9we8ciJywHzsjfHRG5PicwEECwQpunt9Jli2MZpee02Exn/EnLBa47kgRRL/fp93uMBq5VOom2YcnKi816ppOra6haRq6rtNsNrGsN0zT5NUwMAxzyTVdo1qtUi4/yr6FaLVaNBoNZrMZ04knnXXxXBfro0ur+4njOPLDNoPBQLpwsW2bXq+35I4te3Yb27FROsPhEKEGPM/7ds7mUEY812M8HsvN5cqKTKdT5vP5srBprGPpUNmdTCY/991MbL0mlJC6h7K+OrQJVt+J31WV4H+E4J8hsoUH8sUSxdIjmbt7Lq7SXF5nSK6FqqVucqRv86TvCqRkzqzk21xR9vN8AShnNRcFdpW0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"aws-cloudfront\"\n        title=\"\"\n        src=\"/static/e3170a7ac6872a024aec5b7487eceffb/6b671/aws-cloudfront.png\"\n        srcset=\"/static/e3170a7ac6872a024aec5b7487eceffb/f7a0c/aws-cloudfront.png 163w,\n/static/e3170a7ac6872a024aec5b7487eceffb/608ba/aws-cloudfront.png 325w,\n/static/e3170a7ac6872a024aec5b7487eceffb/6b671/aws-cloudfront.png 650w,\n/static/e3170a7ac6872a024aec5b7487eceffb/1ee70/aws-cloudfront.png 975w,\n/static/e3170a7ac6872a024aec5b7487eceffb/f242c/aws-cloudfront.png 1300w,\n/static/e3170a7ac6872a024aec5b7487eceffb/3a344/aws-cloudfront.png 1440w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span>\n  </a></p>\n<p>다음 과정은 링크 테스트인데, 이는 다른 곳에서 클라우드 프론트를 통해 나의 S3안에 있는 파일에 접근할 수 있는지를 확인하는 것이다. 이를 html로 다음과 같이 나타내보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    My CloudFront Test\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>My text content goes here.<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>http://domain name/object name<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>my test image<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>My text content goes here.</p>\n<p><img src=\"http://d2wo4ppcmoy2ow.cloudfront.net/440321838.png\" alt=\"my test image\"></p>\n<p>html의 문법을 마크다운에서도 사용할 수 있으니 직접 삽입해봤는데, 잘 나오지 않는다. 그 이유는 경로가 제대로 설정되지 않았거나, 마크다운에서는 부를 수 없다거나, 처리가 이루어지기 위한 생성 후 20분 ~ 40분의 시간이 지나지 않았기 때문일 것이기 때문에 우선은 가장 후자의 경우를 산정하여 마냥 기다려보기로 하자. 만약 이 글을 읽고 있는 와중에 위의 이미지가 잘 나온다면 제대로 경로를 설정한 것이고, 마크다운에서도 사용 가능하다는 것을 의미한다고 이해하도록 하면 좋을 것이다.</p>\n<blockquote>\n<p>일정 시간이 흘러도 나타나지 않아 오류 메시지를 확인해보니 \"AccessDenied\"라는 오류가 발생하고 있었다. 이는 접근할 수 있는 권한이 없다는 의미인데, 이는 설정에서 JSON-based access policy의 설정을 변경해줘야 한다. 하지만 이는 돌이킬 수 없을 수 있으니 그냥 나중에 EC2에서 각자의 AWS 계정에서 파일을 불러오도록 하는 것으로 방향을 바꿔야겠다.</p>\n<p>만약 S3의 파일을 공개하고 싶다면 S3 버킷을 설정할 때 봤던 권장사항들의 일부를 변경해주어야 한다. 이 점 참고하길 바란다.</p>\n</blockquote>\n<p>여기까지 클라우드 프론트를 설정했다. 하지만 우리는 우리의 서비스가 하나의 아키텍처로 동작하는 것을 바라고 있다. 이제부터는 이를 위해 EC2와 RDS를 설정하는 작업을 진행할 것이다.</p>\n<p>EC2의 경우에는 웹 서버와 애플리케이션 서버로 나누어줘야 하지만, 서비스가 없는 상황에서는 무리한 것 같아 간단하게 1개의 EC2를 index.html에 위의 문장을 삽입해 띄울 것이기 때문에 크게 어려움을 느끼지 않아도 될 것이다. 더불어 RDS에서는 MySQL을 사용해 데이터베이스에 파일의 id와 S3 주소를 저장하는 것으로 사용을 마무리할 것이기 때문에 역시 어렵지않게 이해할 수 있을 것이다.</p>\n<p>우선 Auto Scaling과 ELB를 설정하도록 하자. 이를 위해서는 EC2 인스턴스를 만들어야 하는데, 그 과정은 <a href=\"https://aws.amazon.com/ko/ec2/getting-started/\">Amazon EC2 시작하기</a>의 2번 과정인 \"2단계: Amazon EC2 인스턴스 시작\"부터 진행하면 된다.</p>\n<blockquote>\n<p>그 과정에서는 Auto Scailng Group을 만들 수 있는데, 이는 아래의 이미지를 통해 찾아보고 이를 설정하도록 하자.</p>\n</blockquote>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4ee2830543a9829f432ba125659b15fe/d2a3f/aws-ec2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 650px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 9.28923293455313%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAXElEQVQI13WLSwrAIAwFvf8xBVEolLSYpH7g1eeqmy6GhMkkpJRAcs6IMaKUAjNDrRXuBjeiyylUdXvOL3T84R567xCRzRgDc0601jaXPjhvxyErNsdcd/bs/ngBgM+ajtj3XlwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"aws-ec2\"\n        title=\"\"\n        src=\"/static/4ee2830543a9829f432ba125659b15fe/6b671/aws-ec2.png\"\n        srcset=\"/static/4ee2830543a9829f432ba125659b15fe/f7a0c/aws-ec2.png 163w,\n/static/4ee2830543a9829f432ba125659b15fe/608ba/aws-ec2.png 325w,\n/static/4ee2830543a9829f432ba125659b15fe/6b671/aws-ec2.png 650w,\n/static/4ee2830543a9829f432ba125659b15fe/1ee70/aws-ec2.png 975w,\n/static/4ee2830543a9829f432ba125659b15fe/f242c/aws-ec2.png 1300w,\n/static/4ee2830543a9829f432ba125659b15fe/d2a3f/aws-ec2.png 1421w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span>\n  </a></p>\n<p>저기서 파란색 버튼을 누르게 되면, 인스턴스 생성 이후에 자동으로 Auto Scaling Group 생성으로 넘어갈 수 있다. 여기에서는 그룹 이름과 서브넷을 설정해야 하는데, 서브넷은 되도록 인스턴스와 같은 곳으로 설정하는 것이 좋을 것 같다. 그리고 나서는 Key의 Name을 추가한 뒤 나머지는 기본 설정으로 하고 넘어가도록 하자(Auto Scaling 설정에서 인스턴스 수의 Min과 Max를 조절할 수 있다. 만약 필요하다면 자신에게 맞도록 설정하도록 하자).</p>\n<blockquote>\n<p>ap-northeast-2a에 EC2 인스턴스가 있다면, ap-northeast-2a로 서브넷을 설정하는 것이 혹시 모를 위험 요소를 배제할 수 있고, 직관적으로 구현할 수 있을 거라고 생각하기 때문이다. AWS의 일부 서비스는 가용 영역이 달라지면 서로 연동되지 않는 것들이 있다는 점을 유의하도록 하자.</p>\n<p>더불어 만약 인스턴스를 먼저 만들고, Auto Scaling 그룹을 따로 만들고자 한다면 Security Group에서 Auto Scaling 설정에 대한 그룹을 생성해주면 된다.</p>\n</blockquote>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/94d1d6c91600ad921e2c3356d16be476/3a344/aws-auto-scaling.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 650px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 55.347222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABUklEQVQoz62QaUsCURSG7w8PohDUNHPLTCP60KcWKcXMLXMBg/5HIDSL4+gs3uvbXZpSshLqMA/3zOGc9ywkmjhEJJZEZD+LWCqPdOEc4WQRoXgOW+E0dvey2I5msMPfUJznJnKSRLaIzPEZUkeniKULiGdOED3IgwAMvmNLLEOD67r4ixHfn2M+p3BcD6PRCJqmwbZtjMdjKU4plTDGOMIX+QFUviLGqPLJsrrv+zAMA47jwDRN6LqOyWQi47MZj9kuHJ8BiwX/1kNEZ9VFTTKdTj8ExZSigWVZ0AwTL68m7Jk6iSheu7LnebJACAUmktWKCrUyxULCvp1OTrisHgR/sx8Fl382KVjN+5pLgttRyvDpb448y7uY8An+2UinN8Tj4AmD4TOanT5uqw2Uay2U75qr8Nh9q4v6Qw8NTr3dRa3dx3WlgYtSGZelCq5uqngDuH08B3M8ZdgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"aws-auto-scaling\"\n        title=\"\"\n        src=\"/static/94d1d6c91600ad921e2c3356d16be476/6b671/aws-auto-scaling.png\"\n        srcset=\"/static/94d1d6c91600ad921e2c3356d16be476/f7a0c/aws-auto-scaling.png 163w,\n/static/94d1d6c91600ad921e2c3356d16be476/608ba/aws-auto-scaling.png 325w,\n/static/94d1d6c91600ad921e2c3356d16be476/6b671/aws-auto-scaling.png 650w,\n/static/94d1d6c91600ad921e2c3356d16be476/1ee70/aws-auto-scaling.png 975w,\n/static/94d1d6c91600ad921e2c3356d16be476/f242c/aws-auto-scaling.png 1300w,\n/static/94d1d6c91600ad921e2c3356d16be476/3a344/aws-auto-scaling.png 1440w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n      />\n  </span>\n  </a></p>\n<p>인스턴스를 만들었고, ssh를 이용해 콘솔을 통해 인스턴스에 접근했다면, 홈 디렉터리(ssh로 접속한 바로 그 지점(~))에서 index.html이라는 문서를 만들어 앞선 html을 입력하도록 하고 각자가 원하는 웹 서버(필자는 nodejs로 만들 것이다)를 실행하도로 하자.</p>\n<p>이제 대망의 ELB 설정이 남아있다. ELB를 설정하기 위해서는 EC2 내에서 Elastic IPs로 고정 IP를 발급받아 만들어진 인스턴스에 적용하고, Load Balancers로 로드 밸런싱을 통해 유입에 따른 인스턴스 설정을 해주어야 한다. 이 작업은 <a href=\"https://docs.aws.amazon.com/ko_kr/elasticloadbalancing/latest/classic/elb-getting-started.html\">자습서: 클래식 로드 밸런서 생성</a>를 통해 진행하도록 하자.</p>","id":"632c6fd8-9b04-5685-9334-04154920d97e","timeToRead":7,"frontmatter":{"date":"February 27, 2019","path":"/blog/2019-02-27-aws_ac_web_2","tags":"aws_ac","title":"AWS 아키텍처 - Web Application Hosting 3"}},{"html":"<h2>AWS - Architecture study: WEB APPLICATION HOSTING</h2>\n<ul>\n<li><a href=\"https://media.amazonwebservices.com/architecturecenter/AWS_ac_ra_web_01.pdf\">https://media.amazonwebservices.com/architecturecenter/AWS<em>ac</em>ra<em>web</em>01.pdf</a></li>\n</ul>\n<p>\"AWS Architecture 중에서 가장 기초적으로 구현할 수 있는 모델은 어떤 게 있을까?\"라는 고민이 있었는데, 이번 스터디를 진행하면서 그 부분을 해결할 수 있었다.</p>\n<p>물론, '구현'을 목적으로 한다면, 더 작은 아키텍처를 선정했을테지만, AWS를 제대로 사용하고, 이를 활용하는 수준을 목적으로 한다면 간단하면서도 각 기능이 원활하게 돌아가는 아키텍처를 선정해야 한다는 생각이 있었다. 그래서 이번 스터디를 기회로 AWS 아키텍처 센터에서 기본적으로 제공하는 아키텍처 중 가장 처음 만나볼 수 있는 Web Application Hosting 아키텍처를 구현해보고자 했다.</p>\n<p>일단 위 PDF에 나와있는 서비스 중 전에 사용해본 서비스는 Route 53, S3, ELB, EC2, RDS가 있었다. 하지만 이는 아키텍처를 고려하고 설계를 먼저 한 것이 아니라 필요에 의해서 하나하나 만들었을 뿐이었기 때문에 깊이가 부족하다고 느끼고 있어서 이번 기회에 제대로 알아보려 한다. 아자아자!</p>\n<p>설계는 아키텍처 센터에서 이미 제공하고 있으니 바로 구현을 해야 할텐데, 구현에 앞서 우선적으로 각 서비스가 어떤 것인지를 알아보는 시간이 필요할 것 같아서 각 서비스에 대해 스터디한 내용을 살짝 공유해보려 한다.</p>\n<h3>Amazon Route53</h3>\n<p>우선 <a href=\"https://docs.aws.amazon.com/ko_kr/Route53/latest/DeveloperGuide/Welcome.html\">Amazon Route 53란 무엇입니까?</a>를 참고하도록 하자. 해당 참조에 의하면 도메인 등록, DNS 라우팅, 상태 확인의 3가지 주요 기능을 조합하여 실행할 수 있는 서비스라고 한다. 각 요소를 하나하나 살펴보도록 하자.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e2f6fe34c52e613cd80585054ae48a2f/4977e/dns-routing.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 582px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 76.46048109965635%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACtUlEQVQoz01S2U7bQBTNz/Uj+AKkSqjvfaiqPlV9opuKKhaJh6JKhS5SBQIhWoizQFnq2I4dL2OPl8RrPN7t2HHtGChHM1eW55655849rXKB+QMUReF7cZ5kk6gwUIgcx7Jsd4rSJCvywlWVwDQaVqt8gIpZxShIzvZxmdWh6VMMpAYjAmdGNICSYU3co+dPu2vvmuSKPNfTktQsRQQcx6uaNrXRt+3u9fEfHjsZYhiJtekOxp73Br9OLFX5/uLZ742PNbkoWk25MI49D3meH0bh1EF7m2csDpuMKizKVB9l4KMBSXI8P8tmtWwnK9NinsRRUV1Sqy7jMN3dOJUoVYpKBhoiB0YML4mKh6LqLc6BSij6bc+yNZW1saoqURQ1v6Iw2ds8pXFZt5HAK0CQBV4WBFkEquuEyzsHLw87VVpVrHXR75EEAQAIwuCe/GOr3emzl1C+GPE9hu8zVeS6DCeOJ1uHJ1/b5/N8IZthRjzHaYqexGlDbmQLlFp1mRXzu0HU0Q98CAAUuDipk1sTS1TGojV21WkcZ+m8zBeyzwClAb8kOGM0FElCYEeyYUQhCsWb9RHVbS5syfrQdLQ8LYbSlKYB4KDr+F/WMarXV6TOBOIq25Potg4uTXjtW7Dz6VHnYLUR05rYgu3oeV6PZJbmRV46tnO83xUoinM0O7A8S9AgGSAlT4yxCvCLI+LyCHn1A7XMKbSm4zRK5Sh3gjBLE8syDWNi2nZ+13AjstoIeazAA0lK0kXP2SwRxwPfcwTLE6AMqjMg8rwAIXSRFwZRcIvQr+H97Lxt//1cj6p2WOWbyFUNmjXBm7XX2x9eVS5gxRtRpTSThePh/VJ02nCU9ztPdg9X/3u7Nui80PJy+fHKytISQeIYdoYTuGkZszxtVprFhjkZ0tTV1dVgMKh0IYT+AafFKBmlLOFpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"dns-routing\"\n        title=\"\"\n        src=\"/static/e2f6fe34c52e613cd80585054ae48a2f/4977e/dns-routing.png\"\n        srcset=\"/static/e2f6fe34c52e613cd80585054ae48a2f/30e25/dns-routing.png 163w,\n/static/e2f6fe34c52e613cd80585054ae48a2f/fedab/dns-routing.png 325w,\n/static/e2f6fe34c52e613cd80585054ae48a2f/4977e/dns-routing.png 582w\"\n        sizes=\"(max-width: 582px) 100vw, 582px\"\n      />\n  </span>\n  </a></p>\n<ul>\n<li>\n<p>도메인 등록은 우리가 흔히 알고 있는 것처럼 .com이나 .kr 등의 도메인을 자신만의 이름로 사용할 수 있게 해주는 서비스이다. Ex. <a href=\"https://www.naver.com\">https://www.naver.com</a></p>\n</li>\n<li>\n<p>다음으로 DNS 라우팅은 인터넷 트래픽을 도메인의 리소스로 라우팅하는 것을 말한다. 다시 말해 사용자의 요청이나 입력 등을 등록된 도메인에 전달하는 작업을 말하는 것이다.</p>\n<ul>\n<li>더불어 도메인의 형태가 항상 우리가 알고있는 www~로 시작하는 것만 존재하는 것이 아니라는 것에 유의하자. 우리가 흔히 알고있는 www는 World Wide Web의 약지로, 하나의 규격이다. 가령 <a href=\"https://mail.google.com%EC%99%80\">https://mail.google.com와</a> 같은 도메인의 사용도 가능하다는 것이다.</li>\n<li>그렇다면 위와 같이 모든 도메인을 따로 등록해야 할까? 그건 아니다. 가령 구글을 예로 들자면 구글의 모든 서비스를 Route 53을 통해 하나로 라우팅하고 싶다면 도메인 입력 란에 google.com만 입력하는 것도 방법이다. 이때 이를 최상위 도메인이라고 부를 수 있으며 앞선 메일 혹은 홈 페이지를 하위 도메인으로 설정할 수도 있다.</li>\n<li>DNS에 대한 자세한 내용은 <a href=\"https://aws.amazon.com/ko/route53/what-is-dns/\">DNS란 무엇입니까?</a>을 활용하도록 하자.</li>\n</ul>\n</li>\n<li>\n<p>마지막으로 상태 확인은 통신되고 있는 리소스의 상태를 확인한다는 의미이다. 문서에 따르면 Route 53은 인터넷을 통해 웹 서버 같은 리소스로 자동화된 요청을 보내어 접근 및 사용이 가능하고, 정상 작동 중인지 확인하는 기능을 한다고 한다. 더불어 리소스를 사용할 수 없게 될 때 알림을 수신한다거나 (비정상 리소스가 아닌) 다른 곳으로 인터넷 트래픽을 라우팅할 수도 있다고 한다.</p>\n</li>\n</ul>\n<h3>Amazon CloudFront(CF)</h3>\n<p>CloudFront는 사용해보지 않았기 때문에 무척 궁금했다. 그래서 <a href=\"https://docs.aws.amazon.com/ko_kr/AmazonCloudFront/latest/DeveloperGuide/Introduction.html\">Amazon CloudFront란?</a>을 참고하기로 했다. 문서에 따르면 \"Amazon CloudFront는 .html, .css, .js 및 이미지 파일과 같은 정적 및 동적 웹 콘텐츠를 사용자에게 더 빨리 배포하도록 지원하는 웹 서비스입니다.\"라는 설명을 볼 수 있다.</p>\n<p>잉? 이런 건 EC2를 통해서 하는 게 아니었나? 가만, 다시 살펴보니 <strong>정적 및 동적 웹 콘텐츠</strong>라는 단어가 신경쓰인다. 그렇구나. 이건 내 웹 사이트의 contents에 해당하는 이야기구나! 그렇다면 소스 코드는 왜 있는 걸까? 조금 더 문서를 읽어보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">CloudFront는 엣지 위치라고 하는 데이터 센터의 전 세계 네트워크를 통해 콘텐츠를 제공합니다. CloudFront를 통해 서비스하는 콘텐츠를 사용자가 요청하면 지연 시간이 가장 낮은 엣지 로케이션으로 라우팅되므로 콘텐츠 전송 성능이 뛰어납니다.\n\n- 콘텐츠가 이미 지연 시간이 가장 낮은 엣지에 있는 경우 CloudFront가 콘텐츠를 즉시 제공합니다.\n- 콘텐츠가 엣지 로케이션에 없는 경우 CloudFront는 콘텐츠의 최종 버전에 대한 소스로 지정된 오리진(예: Amazon S3 버킷, MediaPackage 채널, HTTP 서버(예: 웹 서버) 등)에서 콘텐츠를 검색합니다.</code></pre></div>\n<p>이 글을 통해 \"엣지 로케이션이 contents에 대한 Cache 역할을 하는구나!\"라고 이해할 수 있었지만, 그럼에도 왜 EC2에서 할 수 있는 작업을 굳이 CloudFront에서 하는지 몰랐다. 하지만 이런 의문은 다음 문장을 통해 바로 해결할 수 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">예를 들어, CloudFront가 아닌 일반적인 웹 서버에서 이미지를 제공한다고 가정합니다. 예를 들어 http://example.com/sunsetphoto.png URL을 사용하여 sunsetphoto.png라는 이미지를 서비스할 수 있습니다.\n\n사용자는 이 URL로 쉽게 이동해 해당 이미지를 볼 수 있습니다. 하지만 이미지가 발견될 때까지 인터넷으로 이루어진 상호 연결된 네트워크의 복잡한 모음을 통해 네트워크에서 다른 네트워크로 요청이 라우팅되었다는 사실은 아마도 모르고 있을 것입니다.</code></pre></div>\n<p>이는 리다이렉션을 통해 사용자가 콘텐츠에 접근하게 될 경우 발생하는 비용을 줄이고자 하는 목적으로 사용될 수 있음을 암시하고 있다. 앞서 이해한 Cache의 개념을 조금 확장해 사용자의 입장에서 낮은 지연 시간으로 contents를 얻고, 비용을 절약하게 된다는 것을 이해했다.</p>\n<p>이는 언뜻 보기에는 별 것 아닐 수도 있지만, 나에게 있어서는 놀라운 기술일 수밖에 없다. 앞서 언급한 '비용'에는 사용자 경험, 물리 장비, 인력 등 다양한 의미가 포함되어 있고, 이를 단번에 최적화한 기술이기 때문이다. 놀라움도 잠시 다음 문장을 통해서 이해를 다질 수 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">CloudFront는 AWS 백본 네트워크를 통해 콘텐츠를 가장 효과적으로 서비스할 수 있는 엣지로 각 사용자 요청을 라우팅하여 콘텐츠 배포 속도를 높입니다. 일반적으로 CloudFront 엣지가 최종 사용자에게 가장 빨리 제공합니다. AWS 네트워크를 사용하면 사용자의 요청이 반드시 통과해야 하는 네트워크의 수가 줄어들어 성능이 향상됩니다. 파일의 첫 바이트를 로드하는 데 걸리는 지연 시간이 줄어들고 데이터 전송 속도가 빨라집니다.\n\n또한 파일(객체라고도 함)의 사본이 전 세계 여러 엣지 로케이션에 유지(또는 캐시)되므로 안정성과 가용성이 향상됩니다.</code></pre></div>\n<p>정말 너무 환상적인 서비스군! 저렴한 비용으로 각 도시에 나의 콘를 Caching할 수 있다니.. 그럼 놀라움은 잠시 뒤로 하고 다음 서비스를 알아보자.</p>\n<h3>Amazon S3</h3>\n<p>흔히 우리가 Storage 기능을 한다고 알고있는 S3다. 자세한 설명을 하지 않아도 이미 이해하고 있었지만, 내가 하고 있는 이해는 경험에 의한 것이기 때문에 오늘을 기회로 <a href=\"https://docs.aws.amazon.com/ko_kr/AmazonS3/latest/dev/Welcome.html\">Amazon S3란 무엇입니까?</a>를 읽어보도록 하자.</p>\n<p>아무래도 Storage 기능만을 제공하기 때문에 매우 짧다. 그래서 다음의 한 박스로 이를 이해할 수 있겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Amazon Simple Storage Service는 인터넷용 스토리지 서비스입니다. 이 서비스는 개발자가 더 쉽게 웹 규모 컴퓨팅 작업을 수행할 수 있도록 설계되었습니다.\n\nAmazon S3에서 제공하는 단순한 웹 서비스 인터페이스를 사용하여 웹에서 언제 어디서나 원하는 양의 데이터를 저장하고 검색할 수 있습니다. 또한 개발자는 Amazon이 자체 웹 사이트의 글로벌 네트워크 운영에 사용하는 것과 같은 높은 확장성과 신뢰성을 갖춘 빠르고 경제적인 데이터 스토리지 인프라에 액세스할 수 있습니다. 이 서비스의 목적은 규모의 이점을 극대화하고 개발자들에게 이러한 이점을 제공하는 것입니다.\n\n이 가이드는 버킷 및 객체와 같은 Amazon S3의 핵심 개념과, Amazon S3 애플리케이션 프로그래밍 인터페이스(API)를 사용하여 이러한 리소스에 대한 작업 방법을 설명합니다.</code></pre></div>\n<p>S3는 Storage의 기능을 하며 버킷이라고 부르는 단위를 통해 정적 파일을 관리한다는 것을 이해했다. 더불어 콘솔을 통해 제공되는 인터페이스를 활용하거나 API를 통해 코드에서의 활용도 가능할 것이라는 것을 이해할 수 있었다. 구글 드라이브인데 개발에 활용할 수 있겠다!</p>\n<h3>Elastic Load Balancing(ELB)</h3>\n<p>ELB는 로드 밸런싱이라고 부르는 작업을 해주는 서비스로 이해하고 있다. 이것도 지극히 경험적인 이해이므로 <a href=\"https://docs.aws.amazon.com/ko_kr/elasticloadbalancing/latest/userguide/what-is-load-balancing.html\">Elastic Load Balancing란 무엇입니까?</a>를 통해서 정확하게 이해해보자.</p>\n<p>일반적으로 로드 밸런싱이라 하면 트래픽을 분산하기 위해 사용한다고 이해하고 있다. 이에 대한 자세한 내용은 <a href=\"https://ko.wikipedia.org/wiki/%EB%B6%80%ED%95%98%EB%B6%84%EC%82%B0\">부하분산</a>을 통해 알아보도록 하고 이 글에서는 ELB를 알아보도록 하자. 문서에 따른 설명은 다음과 같다. 부가적으로 트래픽을 분산한다는 의미보다는 정해진 수의 CPU나 메모리같은 컴퓨팅 자원에게 작업을 나눠 제공한다고 이해하는 것이 바람직하겠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Elastic Load Balancing는 Amazon EC2 인스턴스, 컨테이너 및 IP 주소와 같은 여러 대상에 대해 수신 애플리케이션 또는 네트워크 트래픽을 여러 가용 영역에 배포합니다. 애플리케이션에 대한 트래픽이 시간이 지남에 따라 변경되므로 Elastic Load Balancing가 로드 밸런서를 확장하고 대다수의 워크로드에 맞게 자동으로 조정할 수 있습니다.</code></pre></div>\n<p>이를 보고 동적인 부하 분산이 가능하겠다고 생각했다. 가령 어떤 날에는 1의 트래픽이, 어떤 날에는 10의 트래픽이 들어오는 서비스에서 트래픽을 처리하려면 10의 가용량을 항상 가지고 있어야 하기 때문에 1의 트래픽이 들어오는 날에는 9의 자원 낭비가 생길 수 있을 것이다. 그런데 이를 동적으로 관리한다면, 들어오는 트래픽에 따라 가용 공간을 늘려 사용할 수 있을 것이기 때문에, 심지어 위 내용에서 '자동'으로 저장할 수 있기 때문에 자원의 낭비를 최소화할 것이라 생각할 수 있었다.</p>\n<p>이런 생각은 문서에서도 나타나고 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">로드 밸런서 이점\n\n로드 밸런서는 워크로드를 가상 서버와 같은 다수의 컴퓨팅 리소스로 분산합니다. 로드 밸런서를 사용하면 애플리케이션의 가용성과 내결함성이 높아집니다.\n\n애플리케이션에 대한 요청의 전체적인 흐름을 방해하지 않고 필요에 따라 로드 밸런서에서 컴퓨팅 리소스를 추가 및 제거할 수 있습니다.\n\n로드 밸런서가 정상적인 대상에만 요청을 보낼 수 있도록 컴퓨팅 리소스의 상태를 모니터링하는 데 사용되는 상태 확인을 구성할 수 있습니다. 또한 컴퓨팅 리소스가 주요 작업에 집중할 수 있도록 암호화 및 복호화 작업을 로드 밸런서로 오프로드할 수 있습니다.</code></pre></div>\n<h3>Amazon EC2</h3>\n<p>흔히 알고 있는 EC2의 경우에도 <a href=\"https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/concepts.html\">Amazon EC2란 무엇입니까?</a>를 통해 살펴보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Amazon Elastic Compute Cloud(Amazon EC2)는 Amazon Web Services(AWS) 클라우드에서 확장식 컴퓨팅을 제공합니다. Amazon EC2를 사용하면 하드웨어에 선투자할 필요가 없어 더 빠르게 애플리케이션을 개발하고 배포할 수 있습니다. Amazon EC2를 통해 원하는 만큼 가상 서버를 구축하고 보안 및 네트워크 구성과 스토리지 관리가 가능합니다. 또한 Amazon EC2는 요구 사항이나 갑작스러운 인기 증대 등 변동 사항에 따라 신속하게 규모를 확장하거나 축소할 수 있어 서버 트래픽 예측 필요성이 줄어듭니다.</code></pre></div>\n<p>이번 정리를 통해 얻은 큰 수확 중 하나는 기존에 당연하게 사용하던 기술의 기능을 한 번에 정리하게 됐다는 점이다. EC2만 하더라도 가상 컴퓨팅 파워를 제공하는 것 외에도 다음과 같은 디테일한 기능을 가지고 있다는 것을 처음으로 알게되었기 때문이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Amazon EC2의 기능\nAmazon EC2는 다음의 기능을 제공합니다.\n\n- 인스턴스: 가상 컴퓨팅 환경\n- Amazon 머신 이미지(AMI): 서버에 필요한 운영체제와 여러 소프트웨어들이 적절히 구성된 상태로 제공되는 템플릿으로 인스턴스를 쉽게 만들 수 있습니다.\n- 인스턴스 유형: 인스턴스를 위한 CPU, 메모리, 스토리지, 네트워킹 용량의 여러 가지 구성 제공\n- 키 페어를 사용하여 인스턴스 로그인 정보 보호(AWS는 퍼블릭 키를 저장하고 사용자는 개인 키를 안전한 장소에 보관하는 방식)\n- 인스턴스 스토어 볼륨: 임시 데이터를 저장하는 스토리지 볼륨으로 인스턴스 종료 시 삭제됨\n- Amazon Elastic Block Store(Amazon EBS), 즉 Amazon EBS 볼륨을 사용해 영구 스토리지 볼륨에 데이터 저장\n- 인스턴스와 Amazon EBS 볼륨 등의 리소스를 다른 물리적 장소에서 액세스할 수 있는 지역 및 가용 영역\n- 보안 그룹을 사용해 인스턴스에 연결할 수 있는 프로토콜, 포트, 소스 IP 범위를 지정하는 방화벽 기능\n- 탄력적 IP 주소(EIP): 동적 클라우드 컴퓨팅을 위한 고정 IPv4 주소\n- 태그: 사용자가 생성하여 Amazon EC2 리소스에 할당할 수 있는 메타데이터\n- AWS 클라우드에서는 논리적으로 격리되어 있지만, 원할 때 마다 고객의 네트워크와 간편히 연결할 수 있는 가상 네트워크, Virtual Private Clouds(VPC)</code></pre></div>\n<p>물론 이런 기능들의 디테일을 설정하기 위해서는 보다 많은 스킬업이 필요하겠지만, '가능하다' 정도만 이해하고 넘어가는 것도 나중에 트러블 슈팅, 비용 최적화 등을 위해 큰 도움이 될 것만 같다. 정말 좋다!</p>\n<p>추가적으로 따로 단락을 만들어 언급하려 했던 <a href=\"https://docs.aws.amazon.com/ko_kr/autoscaling/ec2/userguide/what-is-amazon-ec2-auto-scaling.html\">Amazon EC2 Auto Scaling</a>을 간단히 소개해보자면, 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Amazon EC2 Auto Scaling를 통해 애플리케이션의 로드를 처리할 수 있는 정확한 수의 Amazon EC2 인스턴스를 보유하도록 보장할 수 있습니다. Auto Scaling 그룹이라는 EC2 인스턴스 모음을 생성합니다. 각 Auto Scaling 그룹의 최소 인스턴스 수를 지정할 수 있으며, Amazon EC2 Auto Scaling에서는 그룹의 크기가 이 값 아래로 내려가지 않습니다. 각 Auto Scaling 그룹의 최대 인스턴스 수를 지정할 수 있으며, Amazon EC2 Auto Scaling에서는 그룹의 크기가 이 값을 넘지 않습니다. 원하는 용량을 지정한 경우 그룹을 생성한 다음에는 언제든지 Amazon EC2 Auto Scaling에서 해당 그룹에서 이만큼의 인스턴스를 보유할 수 있습니다. 조정 정책을 지정했다면 Amazon EC2 Auto Scaling에서는 애플리케이션의 늘어나거나 줄어드는 수요에 따라 인스턴스를 시작하거나 종료할 수 있습니다.</code></pre></div>\n<p>Auto Scaling은 규모가 있는 서비스에서 필수적으로 필요할 것이라 생각된다. 왜냐하면 EC2의 인스턴스가 자동으로 스케일을 조정하는 경우는 트래픽이 많지 않으면 필요없을 것이라고 생각하기 때문이다. 하지만 이는 다소 편향된 생각이다. Auto-Scailing을 설정하지 않으면 만약 우리 서비스의 트래픽이 급격하게 증가하는 경우에는 서버가 버티지 못할 것이기 때문이다. 스타트업의 경우라면 만에 하나 있을 '대박'의 기회를 한순간에 놓칠 수도 있을 거라고 생각한다.</p>\n<p>최소한의 인스턴스 수를 유지하면서 트래픽이 급격하게 증가할 경우에는 자동적으로 스케일 업을 진행하게 구현한다면 트래픽의 갑작스러운 변화에도 신속히 대응할 수 있을 것이라고 느꼈다. 문서에서는 다음과 같은 예시를 들어 이해를 돕는다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">예를 들어, 다음 Auto Scaling 그룹의 경우 최소 인스턴스 수 1개, 희망 인스턴스 용량 2개, 최대 인스턴스 수 4개가 됩니다. 사용자가 정의한 조정 정책에 따라 인스턴스 수가 최소 및 최대 인스턴스 수 내에서 지정하는 조건에 따라 조절됩니다.</code></pre></div>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7b4c8ac32129aab596d7f10b471ac0c2/5a54c/auto-scailing.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 310px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 72.25806451612904%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACeUlEQVQoz31Ry27aUBC9f5NVpapdV/2HfkIfiy6qfkA/oJW6atJtd1VVJQISaAATcB48QgQ2YMBP7GtsHoEQWyQkUgLX07FJF120R8fjudI5c2fuEPiDIAgwmhZtSS1NVWS522y2Wi2J2n1F1bqy2ndc+BtkNnb82cT3fM/zr3xPrBYPOK56Wq2UKzyXLmRTqfg2Rp7bLx/l5rOxfzF64HRIpo0ktL+t8q9Z/hWrfYZRFVqfoPQWKu+B7sHwBIw4mLtgJ8E9YtouU3aY/JOpcWbmyaXMw9GbYJMAMvE8cErB9w08BlskqHwIzExgpgP7MNBigcWBHgeaA7sQVrR5ctnlgX+5+kLYJmGxZ+CU4McGfCUhQzPHkPYJ0/fCRIszq8DoIdMTQAtk1toH6WOw+xQST+D0HbhFyL6A7Uew8xgaW+AcAI1D/xdYO+DyYfM0EUYLzQdkrNfUGq/WjzXhWKrkLkxxPlA9V0HOh6otlTqllHya7lbSep2Xq9luZR+pnuU8WyLXixup0xUbzabUVnVjfn2DG2MAq2hzg9G43VU1o2eYtCaIimboPSqrhmaYS8aIYejFYlEUhEajYZq9er12fn6ONsawAtiUFosnnU47WnvD6OmCIJTLJUGoo4Dc399PJpPb29urCJ7nLRYLPM7nc9/30b9cLlcRMEHDOl+XJvh1Op1kMsnzfDab5TiuUCjkcrl8Pr82B//Ag/nu7k5RFMuyer0ediGKoq7rlNK14j8I29Y0zXGcfgT0YBwMBlgFc9u2MXddFwVY2oyA16AFBwxvxh8qRqPRMALacIRYLJZKpTKZDD4nDnJ2djadTlEzjoCPimP/Bqt9zXDfGFTyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"auto-scailing\"\n        title=\"\"\n        src=\"/static/7b4c8ac32129aab596d7f10b471ac0c2/5a54c/auto-scailing.png\"\n        srcset=\"/static/7b4c8ac32129aab596d7f10b471ac0c2/85daf/auto-scailing.png 163w,\n/static/7b4c8ac32129aab596d7f10b471ac0c2/5a54c/auto-scailing.png 310w\"\n        sizes=\"(max-width: 310px) 100vw, 310px\"\n      />\n  </span>\n  </a></p>\n<h3>Amazon RDS</h3>\n<p>대망의 마지막 서비스이다! 이 설명이 끝나면 이제 구현이 가능하다! <a href=\"https://docs.aws.amazon.com/ko_kr/AmazonRDS/latest/UserGuide/Welcome.html\">Amazon Relational Database Service(Amazon RDS)란 무엇입니까?</a>를 살펴보면, RDS를 다음과 같이 설명하고 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Amazon Relational Database Service(Amazon RDS)는 클라우드에서 관계형 데이터베이스를 더 쉽게 설치, 운영 및 확장할 수 있는 웹 서비스입니다. 이 서비스는 산업 표준 관계형 데이터베이스를 위한 경제적이고 크기 조절이 가능한 용량을 제공하고 공통 데이터베이스 관리 작업을 관리합니다.</code></pre></div>\n<p>일반적인 RDB(Relatinal Database)를 구현하기 위해선 따로 DB 서버를 두거나 하나의 서버에 해당 SQL의 DBMS를 설치해 콘솔 혹은 별도의 GUI 프로그램을 사용해야 했다. 하지만 RDS는 모든 DBMS의 UI를 하나로 통합해 제공하기 때문에 DBMS의 변경, 이주(Migation), 통합(Integration) 등에서 발생하는 정신적 스트레스, 별도의 학습 코스트를 최소화할 수 있을 것이다. 더불어 RDS는 별도의 Database 관리가 없이도 모니터링, 테이블 변경 등의 처리를 할 수 있어 이를 통해 다양한 비용을 절약할 수 있을 것이다.</p>\n<p>이러한 필자의 생각은 문서 하단의 설명에서도 나온다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Amazon RDS의 개요\n\n관리되는 관계형 데이터베이스 서비스가 필요한 이유는 무엇일까요? Amazon RDS가 어렵거나 지루한 관계형 데이터베이스 관리 작업을 대다수 대신하기 때문입니다.\n\n- 서버를 구입하면 CPU, 메모리, 스토리지 및 IOPS가 모두 한데 묶여 제공됩니다. Amazon RDS를 사용하면 이 모두가 따로 분할되므로 독립적으로 확장할 수 있습니다. CPU가 더 많이 필요하거나 IOPS가 더 적게 필요하거나 스토리지가 더 많이 필요할 경우 쉽게 할당할 수 있습니다.\n- Amazon RDS는 백업, 소프트웨어 패치, 자동 장애 감지 및 복구를 관리합니다.\n- 관리형 서비스 환경을 제공하기 위해 Amazon RDS는 DB 인스턴스에 대해 shell 액세스를 제공하지 않으며, 고급 권한을 필요로 하는 특정 시스템 절차와 테이블에 대한 액세스를 제한합니다.\n- 필요할 때 자동화된 백업을 수행하거나 고유한 백업 스냅샷을 수동으로 만들 수 있습니다. 이러한 백업을 사용하여 데이터베이스를 복원할 수 있습니다. Amazon RDS 복원 프로세스는 안정적이고 효율적입니다.\n- 기본 인스턴스 및 문제 발생 시 장애 조치를 수행할 수 있는 동기식 보조 인스턴스에서 가용성을 높일 수 있습니다. MySQL, MariaDB 또는 PostgreSQL 읽기 전용 복제본을 사용해 읽기 조정을 높일 수도 있습니다.\n- 이미 친숙한 MySQL, MariaDB, PostgreSQL, Oracle 및 Microsoft SQL Server 같은 데이터베이스 제품을 사용할 수 있습니다.\n- 데이터베이스 패키지의 보안 외에도 AWS Identity and Access Management(IAM)을 사용해 사용자 및 권한을 정의하는 방법으로 RDS 데이터베이스에 액세스할 수 있는 사용자를 제어할 수 있습니다. 데이터베이스를 가상 사설 클라우드에 넣어 데이터베이스를 보호할 수도 있습니다.</code></pre></div>\n<p>RDS에는 DB 인스턴스라는 단위가 존재한다. DB 인스턴스는 RDS의 기본 빌딩 블록(최소 단위)라고 할 수 있다. 더불어 DB 인스턴스는 클라우드에 존재하기 때문에 서비스와는 완전히 격리된 데이터베이스 환경이다. 그렇기 때문에 서비스 운영의 호환성을 고려하지 않아도 된다는 장점을 가지고 있다.</p>\n<p>지금은 이정도만 이해하고 넘어가도 서비스를 사용함에 문제가 없다. 하지만, 더욱 자세한 설명을 원한다면 위에 제공된 링크를 통해 더욱 깊이 학습하도록 하자.</p>\n<p>이제서야 이번 아키텍처에서 사용하는 모든 서비스를 정리할 수 있었다. 하지만, 아직 아키텍처의 전반적인 설명을 하지 않았기 때문에 이를 설명할 필요도 있다고 생각하기 때문에 지금까지의 내용을 정리할 겸 사용자의 흐름에 따라 다음과 같이 요약할 수 있다.</p>\n<ol>\n<li>유저는 DNS 응답(requests)를 하나의 고가용성 DNS 서비스인 Amazon Route53에 보낸다. 이때 네트워크 트래픽은 AWS에서 실행되는 인프라(Infrastructure)로 라우팅된다.</li>\n<li>정적, 동적, 실시간 콘텐츠는 하나의 글로벌 엣지 로케이션(일종의 Conetns Cache) 네트워크인 CloudFront에 의해 전달된다. 이때 응답(requests)은 자동적으로 가장 가까운 엣지 로케이션으로 라우팅되고, 그래서 콘텐츠는 최적의 가용성을 가지고 전달된다.</li>\n<li>자원(Resources)과 정적 콘텐츠는 미션 크리티컬 및 기본 데이터 스토리지를 위해 고안된 내구성이 뛰어난 스토리지 인프라인 S3 위에 적재된(stored) 웹 어플리케이션에 의해 사용된다.</li>\n<li>HTTP 응답은 우선적으로 가용 영역(AZs)에서 다수의 Amazon Elastic Compute Cloud(EC2) 인스턴스로 들어오는 애플리케이션 트래픽을 자동으로 배분하는 ELB에 의해 처리(handled)되어진다.</li>\n<li>웹 서버와 애플리케이션 서버는 EC2 위에서 배포되어진다. 여기서 대부분의 조직은 AMI(Amazon Machine Image)를 선택한 다음 필요에 맞게 사용자 정의합니다. 이 사용자 정의된(custom) AMI는 앞으로의 웹 개발의 출발점이 될 것이다.</li>\n<li>웹 서버와 애플리케이션 서버는 Auto Scailing 그룹 안에서 배포되어진다. 이때 Auto Scaling은 정의한 조건에 따라 자동으로 용량을 늘리거나 줄이면서 조절합니다. Auto Scailing 기능을 사용하면 성능을 유지하기 위해 요구 사항이 급증 할 때 사용중인 EC2의 인스턴스의 수가 무사히 증가하고, 요구 사항이 발생하면 자동적으로 감소하여 비용을 최소화 할 수 있습니다.</li>\n<li>고가용성을 제공하기 위해 어플리케이션 데이터가 포함된 관계형 데이터베이스는 RDS의 다중 가용구역(Multi-AZ, Master-Slave) 배포 위에서 중복적으로(redundantly) 호스팅된다.</li>\n</ol>\n<p>드디어 실습을 위한 사전 학습이 마무리됐다. 이 글 이후에는 실습을 위한 자료를 제공해 보다 나은 학습을 진행하고자 한다.</p>\n<p><a href=\"https://rayleighko.github.io/blog/2019-02-27-aws_ac_web_2\">다음 글(실습)</a></p>","id":"0e95e14b-9059-5f6f-884e-3e22e09543c9","timeToRead":11,"frontmatter":{"date":"February 25, 2019","path":"/blog/2019-02-25-aws_ac_web_2","tags":"aws_ac","title":"AWS 아키텍처 - Web Application Hosting 2"}},{"html":"<h1>AWS 아키텍처 - Web Application Hosting</h1>\n<p>What is <code class=\"language-text\">Web-Application Hosting</code> in <a href=\"https://media.amazonwebservices.com/architecturecenter/AWS_ac_ra_web_01.pdf\">AWS Reference Architecture</a>?</p>\n<div class=\"gatsby-highlight\" data-language=\"english\"><pre class=\"language-english\"><code class=\"language-english\">Highly available and scalable web hosting can be complex and expensive.\nDense peak periods and wild swings in traffic patterns result in low utilization of expensive hardware.\n\nAmazon Web Services provides the reliable, scalable, secure, and high- performance infrastructure required for web applications while enabling an elastic, scale-out and scale-down infrastructure to match IT costs in real time as customer traffic fluctuates.</code></pre></div>\n<p><a href=\"https://media.amazonwebservices.com/architecturecenter/AWS_ac_ra_web_01.pdf\">AWS Reference Architecture</a>에서 제공하는 <code class=\"language-text\">Web-Application Hosting</code>은 무엇일까?</p>\n<div class=\"gatsby-highlight\" data-language=\"korean\"><pre class=\"language-korean\"><code class=\"language-korean\">고가용성 및 확장성 웹 호스팅은 복잡하고 비용이 많이 듭니다.\n이는 트래픽 패턴이 짙어지면서 피크 시간이 길어지고 값 비싼 하드웨어의 사용률이 낮아집니다.\n\nAmazon Web Services에서는 웹 애플리케이션에 필요한 안정적이고 확장 가능하며 안전한 고성능 인프라를 제공하는 동시에 고객 트래픽이 변동함에 따라 IT 비용을 실시간으로 일치시킬 수있는 유연한 스케일 아웃 및 축소형 인프라를 제공합니다.</code></pre></div>","id":"c6159e13-c069-5150-8e90-c446ca5a4c0e","timeToRead":1,"frontmatter":{"date":"February 12, 2019","path":"/blog/2019-02-12-aws_ac_web_01","tags":"aws_ac","title":"AWS 아키텍처 - Web Application Hosting_01"}}],"tag":"aws_ac","pagesSum":1,"page":1}}